<!-- 引入 jQuery 和 jQuery Transit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.transit/0.9.12/jquery.transit.min.js"></script>
<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TickEasy - 訂單確認</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      /* 付款提示區塊 */
      .warning-box {
        background-color: #fff3cd;
        border: 3px solid #ffeaa7;
        display: flex;
        align-items: center;
        justify-content: center;
        .warning-icon {
          background-color: #f39c12;
          color: white;
          width: 36px;
          height: 36px;
          border-radius: 50%;
          display: inline-flex;
          align-items: center;
          justify-content: center;
          margin-right: 1rem;
          font-size: 20px;
          font-weight: bold;
        }
      }

      /* 活動資訊區塊 */
      .event-box .event-image {
        width: 300px;
        height: 200px;
        object-fit: cover;
      }

      /* 購票明細區塊 */
      .table-container {
        /* dropdown 箭頭動畫 */
        & .dropdown-arrow {
          cursor: pointer;
          transition: transform 0.3s;
        }
        & .dropdown-arrow.is-active {
          transform: rotate(180deg);
        }

        /* 票券明細動畫 */
        & .ticket-details {
          display: none;
        }
        & .ticket-details.is-active {
          display: table-row;
        }
        & .ticket-item-box {
          box-shadow: none;
          border: 1px solid #dbdbdb;
        }
      }
    </style>
  </head>
  <body>
    <!-- 主內容 -->
    <main class="section">
      <div class="container">
        <!-- 付款提示區塊 -->
        <div class="notification is-warning is-light warning-box">
          <span class="warning-icon">!</span>
          <span class="has-text-weight-semibold is-size-4"
            >您的訂單尚未付款</span
          >
        </div>

        <!-- 活動資訊區塊 -->
        <div class="box event-box">
          <div class="columns is-vcentered">
            <div class="column is-narrow">
              <figure class="image">
                <img
                  src="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=300&h=200&fit=crop"
                  alt="2024春季音樂節"
                  class="event-image is-rounded"
                />
              </figure>
            </div>
            <div class="column">
              <h2 class="title is-4">2024 春季音樂節</h2>
              <div class="content">
                <p><strong>時間：</strong>2024/03/15 19:30</p>
                <p><strong>地點：</strong>台北市信義區信義路五段7號</p>
                <p><strong>主辦單位：</strong>春季音樂營運策劃有限公司</p>
              </div>
            </div>
          </div>
        </div>

        <!-- 購票明細區塊 -->
        <div class="box has-background-warning-light p-0">
          <h3 class="title is-5 has-text-centered pt-5">購票明細</h3>
          <div class="table-container mb-0">
            <table class="table is-fullwidth is-hoverable">
              <thead>
                <tr>
                  <th class="py-4">票種</th>
                  <th class="has-text-centered py-4">數量</th>
                  <th class="has-text-centered py-4">單價</th>
                  <th class="has-text-centered py-4">金額</th>
                  <th class="has-text-centered py-4">操作</th>
                </tr>
              </thead>
              <tbody>
                <!-- VIP票表格 -->
                <tr>
                  <td class="has-text-weight-semibold py-4">VIP區</td>
                  <td class="has-text-centered py-4">2</td>
                  <td class="has-text-centered py-4">NT$ 2,800</td>
                  <td class="has-text-centered has-text-weight-semibold py-4 d">
                    NT$ 5,600
                  </td>
                  <td class="has-text-centered py-4">
                    <span
                      class="dropdown-arrow has-text-grey"
                      data-ticket-type="vip"
                      ticket-item-box
                    >
                      <i class="fas fa-chevron-down"></i>
                    </span>
                  </td>
                </tr>
                <!-- VIP票票券明細 -->
                <tr class="ticket-details" id="ticket-details-vip">
                  <td colspan="5" class="p-0" style="border: none">
                    <div
                      class="ticket-details-content has-background-light p-5"
                      style="width: 100%"
                    >
                      <div class="columns is-centered">
                        <div class="column is-8">
                          <div class="box is-small ticket-item-box mb-5">
                            <div class="columns is-vcentered">
                              <div class="column">
                                <strong>票券 #VIP區 (1/2)</strong>
                              </div>
                              <div class="column is-narrow">
                                <span class="has-text-grey">NT$ 2,800</span>
                              </div>
                            </div>
                            <div class="notification is-light is-small">
                              <div class="is-size-7 has-text-grey">持有人</div>
                              <div class="has-text-weight-semibold">buyer2</div>
                              <div class="is-size-7 has-text-grey">
                                F123456789
                              </div>
                            </div>
                          </div>

                          <div class="box is-small ticket-item-box">
                            <div class="columns is-vcentered">
                              <div class="column">
                                <strong>票券 #VIP區 (2/2)</strong>
                              </div>
                              <div class="column is-narrow">
                                <span class="has-text-grey">NT$ 2,800</span>
                              </div>
                            </div>
                            <div class="notification is-light is-small">
                              <div class="is-size-7 has-text-grey">持有人</div>
                              <div class="has-text-weight-semibold">buyer2</div>
                              <div class="is-size-7 has-text-grey">
                                F123456789
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </td>
                </tr>
                <!-- 一般票表格 -->
                <tr>
                  <td class="has-text-weight-semibold py-4">一般票</td>
                  <td class="has-text-centered py-4">1</td>
                  <td class="has-text-centered py-4">NT$ 1,000</td>
                  <td class="has-text-centered has-text-weight-semibold py-4">
                    NT$ 1,000
                  </td>
                  <td class="has-text-centered py-4">
                    <span
                      class="dropdown-arrow has-text-grey"
                      data-ticket-type="general"
                    >
                      <i class="fas fa-chevron-down"></i>
                    </span>
                  </td>
                </tr>
                <!-- 一般票票券明細 -->
                <tr class="ticket-details" id="ticket-details-general">
                  <td colspan="5" class="p-0" style="border: none">
                    <div
                      class="ticket-details-content has-background-light p-5"
                      style="width: 100%"
                    >
                      <div class="columns is-centered">
                        <div class="column is-8">
                          <div class="box is-small ticket-item-box">
                            <div class="columns is-vcentered">
                              <div class="column">
                                <strong>票券 #一般票 (1/1)</strong>
                              </div>
                              <div class="column is-narrow">
                                <span class="has-text-grey">NT$ 1,000</span>
                              </div>
                            </div>
                            <div class="notification is-light is-small">
                              <div class="is-size-7 has-text-grey">持有人</div>
                              <div class="has-text-weight-semibold">buyer1</div>
                              <div class="is-size-7 has-text-grey">
                                E123456789
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- 金額合計 -->
        <div class="notification is-light">
          <div class="columns is-vcentered">
            <div class="column">
              <span class="title is-5">合計</span>
            </div>
            <div class="column is-narrow">
              <span class="title is-4 has-text-primary">NT$ 6,600</span>
            </div>
          </div>
        </div>

        <!-- 上/下一步按鈕區域 -->
        <div class="field is-grouped is-grouped-centered mt-5">
          <div class="control">
            <button class="button is-large is-light">返回</button>
          </div>
          <div class="control">
            <button class="button is-large is-primary">付款去</button>
          </div>
        </div>
      </div>
    </main>

    <script>
      (() => {
        // 綁定 dropdow-arraow 元素點擊事件
        $(".dropdown-arrow").on("click", (e) => {
          // 抓取元素
          const $clickElement = $(e.target).closest(".dropdown-arrow");
          const $details = $clickElement.closest("tr").next(); // 找到 dropdown-arrow 按鈕下方的 ticket-details 元素
          const $arrow = $clickElement.find("i");

          if ($details.hasClass("is-active")) {
            // 隱藏詳細資訊 - 先動畫再隱藏
            $details.transition({ opacity: 0, y: "-10px" }, 300, () => {
              $details.removeClass("is-active");
            });
            $arrow.transition({ rotate: "0deg" }, 200); // 箭頭旋轉動畫
          } else {
            // 顯示詳細資訊 - 先顯示再動畫
            $details.addClass("is-active");
            $details.transition({ opacity: 1, y: "0px" }, 300);
            $arrow.transition({ rotate: "180deg" }, 200); // 箭頭旋轉動畫
          }
        });
      })();
    </script>
  </body>
</html>
